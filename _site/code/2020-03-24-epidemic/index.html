<!DOCTYPE html>
<!--
    So Simple Jekyll Theme 3.2.0
    Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
    Free for personal and commercial use under the MIT license
    https://github.com/mmistakes/so-simple-theme/blob/master/LICENSE
-->
<html lang="en-US" class="no-js">
  <meta charset="utf-8">
<title>ABCs of mathematical epidemiology &#8211; Pena, WTF?</title>
<meta name="description" content="Jupyter notebooks on infectious disease dynamics.

">
<meta name="keywords" content="">


<!-- Twitter Cards -->
<meta name="twitter:title" content="ABCs of mathematical epidemiology">
<meta name="twitter:description" content="Jupyter notebooks on infectious disease dynamics.

">



<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://localhost:4000/images/lines.png">

<!-- Open Graph -->
<meta property="og:locale" content="">
<meta property="og:type" content="article">
<meta property="og:title" content="ABCs of mathematical epidemiology">
<meta property="og:description" content="Jupyter notebooks on infectious disease dynamics.

">
<meta property="og:url" content="http://localhost:4000/code/2020-03-24-epidemic/">
<meta property="og:site_name" content="Pena, WTF?">





<link rel="canonical" href="http://localhost:4000/code/2020-03-24-epidemic/">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Pena, WTF? Feed">

<!-- https://t.co/dKP3o1e -->

<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Jekyll SEO plugin -->
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>ABCs of mathematical epidemiology | Pena, WTF?</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="ABCs of mathematical epidemiology" />
<meta name="author" content="pena" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Jupyter notebooks on infectious disease dynamics." />
<meta property="og:description" content="Jupyter notebooks on infectious disease dynamics." />
<link rel="canonical" href="http://localhost:4000/code/2020-03-24-epidemic/" />
<meta property="og:url" content="http://localhost:4000/code/2020-03-24-epidemic/" />
<meta property="og:site_name" content="Pena, WTF?" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-24T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="ABCs of mathematical epidemiology" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"pena"},"dateModified":"2020-03-24T00:00:00+02:00","datePublished":"2020-03-24T00:00:00+02:00","description":"Jupyter notebooks on infectious disease dynamics.","headline":"ABCs of mathematical epidemiology","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/code/2020-03-24-epidemic/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/lines.png"},"name":"pena"},"url":"http://localhost:4000/code/2020-03-24-epidemic/"}</script>
<!-- End Jekyll SEO tag -->


<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">
<!-- Webfonts -->
<script src="https://use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="http://localhost:4000/assets/js/vendor/html5shiv.min.js"></script>
  <script src="http://localhost:4000/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://localhost:4000/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>


<!-- MathJax -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">


  <body class="layout--post  abcs-of-mathematical-epidemiology">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#primary-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <div class="navigation-wrapper">
	<a href="#menu-toggle" id="menu-toggle">Menu</a>
	<nav role="navigation" id="primary-nav" class="site-nav animated drop">
	    <ul>
      
		    
		    <li><a href="http://localhost:4000/" >Home</a></li>
		  
		    
		    <li><a href="http://localhost:4000/about" >About</a></li>
		  
		    
		    <li><a href="http://localhost:4000/math/" >Math</a></li>
		  
		    
		    <li><a href="http://localhost:4000/music/" >Music</a></li>
		  
		    
		    <li><a href="http://localhost:4000/other/" >Other</a></li>
		  
		    
		    <li><a href="http://localhost:4000/code/" >Code</a></li>
		  
		    
		    <li><a href="http://localhost:4000/katalikko/" >Katalikko</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->


<header class="masthead">
	<div class="wrap">
      
  		<a href="http://localhost:4000/" class="site-logo" rel="home" title="Pena, WTF?"><img id="sitelogo" src="http://localhost:4000/images/lines.png" width="200" height="200" alt="Pena, WTF? logo" class="site-logo-img animated fadeInDown"></a>
      
    <!--
 <h1 class="site-title animated fadeIn"><a href="http://localhost:4000/">Pena, WTF?</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">the bestest site in the multiverse<br></h2>
     -->
	</div>
</header><!-- /.masthead -->

<div class="js-menu-screen menu-screen"></div>


<!-- end of navigation.html -->

    <header class="masthead">
  <div class="wrap">
<!-- fuck this
    
      <a href="/" class="site-logo" rel="home" title="Pena, WTF?">
        <img src="/lines.png" class="site-logo-img animated fadeInDown" alt="Pena, WTF?">
      </a>
-->
    
    
    
      
        <div class="site-title animated fadeIn"><a href="/">Pena, WTF?</a></div>
      
       <!--
      <p class="site-description animated fadeIn" itemprop="description">the bestest site in the multiverse<br></p>
         -->
      <div class="site-description animated fadeIn" id="inspirational"> </div>
    
  </div>
</header><!-- /.masthead -->


    <main id="main" class="main-content" aria-label="Content">
  <article class="h-entry">
    

    <div class="page-wrapper">
      <header class="page-header">
        
        
          <h1 id="page-title" class="page-title p-name">ABCs of mathematical epidemiology
</h1>
        
      </header>

      <div class="page-sidebar">
        <div class="page-author h-card p-author"><img src="/images/bena.jpg" class="author-avatar u-photo" alt="pena"><div class="author-info"><div class="author-name">
        <span class="p-name">pena</span>
      </div><ul class="author-links"><li class="author-link">
            <a class="u-url" rel="me" href="https://github.com/gingerdeer"><i class="fab fa-github-square fa-lg" title="GitHub"></i></a>
          </li><li class="author-link">
            <a class="u-url" rel="me" href="https://www.linkedin.com/in/pentti-sunila-a967a1123/"><i class="fab fa-linkedin fa-lg" title="LinkedIn"></i></a>
          </li><li class="author-link">
            <a class="u-url" rel="me" href="https://soundcloud.com/gidetrix"><i class="fab fa-soundcloud fa-lg" title="SoundCloud"></i></a>
          </li><li class="author-link">
            <a class="u-url" rel="me" href="https://dream-lands.bandcamp.com/"><i class="fab fa-bandcamp fa-lg" title="Bandcamp"></i></a>
          </li><li class="author-link">
            <a class="u-url" rel="me" href="https://twitter.com/_penatrix"><i class="fab fa-twitter fa-lg" title="Twitter"></i></a>
          </li></ul>
    <time class="page-date dt-published" datetime="2020-03-24T00:00:00+02:00"><a class="u-url" href="">March 24, 2020</a>
</time>

  </div>
</div>

        

        

      </div>

      <div class="page-content">
        <div class="e-content">
          <p>Jupyter notebooks on infectious disease dynamics.</p>

<p><a href="https://github.com/gingerdeer/infectionmodelingcourse">From my Github.</a></p>

<p>The topic is fashionable at the moment due to the Corona virus situation, so I decided to post these notebooks here. I wrote them during a course on mathematical modeling of infectious disease dynamics and they cover some of the basic topics from the course. These so-called compartmental models of epidemiology are famous, mathematically and intuitively simple, and also powerful. Many papers published nowadays still rely on more complicated and detailed models based on these (including papers on Covid-19). The SIR model is a highly famous fundamental model and a lot has been written about it in literature and online.</p>

<h1 id="sir-model">SIR-model</h1>
<p>This is the most famous model. The equations governing it are as follows:</p>

\[\frac{dS}{dT} = - \beta S I\]

\[\frac{dI}{dT} = \beta S I - \nu I\]

\[\frac{dR}{dT} = \nu I\]

<p>They represent three categories in the population of interest: Susceptibles (those who haven’t been infected yet), Infected (those with the illness being modeled), and Recovereds (those who have recovered and gained immunity, or alternatively died, such that they aren’t vulnerable to the illness anymore). The constants ( \beta ) and ( \nu ) are determined by the specific illness, by how infectious it is, and how long on average it takes to recover or die from it. The interpretation is that for all contacts between Susceptibles and Infecteds, there is a rate at which the disease is transferred, and a certain rate at which the Infected population recovers from the disease.</p>

<p>Variations can be easily added to the equations to produce more elaborate models. For example, it is possible to add birth and death rates in the general populations as terms in the equations, or add more equations and therefore categories to account for possible latent periods and to differentiate between dead and recovered individuals.</p>

<p>Similarly, differentiation between sexes can be made, for example, in the case of sexually transmitted diseases. Age groups could also be added, if they are affected differently by the disease.</p>

<p>Such a system of ordinary differential equations is easily integrated and simulated with code such as the following. I probably copypasted most of it from some other blog anyway.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># Analysis &amp; visualization of the basic SIR model
</span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
<span class="kn">import</span> <span class="nn">pylab</span>
<span class="c1"># This allows using \TeX in matplotlib
</span><span class="n">plt</span><span class="p">.</span><span class="n">rc</span><span class="p">(</span><span class="s">'text'</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">rc</span><span class="p">(</span><span class="s">'font'</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s">'serif'</span><span class="p">)</span>

<span class="c1"># Set parameters
</span><span class="n">beta</span> <span class="o">=</span> <span class="mf">0.21</span>
<span class="n">nu</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">N</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># basic reproduction number
</span><span class="n">R0</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">/</span> <span class="n">nu</span>

<span class="c1"># Define model
</span><span class="k">def</span> <span class="nf">SIR</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
    <span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">R</span> <span class="o">=</span> <span class="n">Y</span>
    <span class="n">dSdt</span> <span class="o">=</span>  <span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">S</span><span class="o">*</span><span class="n">I</span>
    <span class="n">dIdt</span> <span class="o">=</span>  <span class="n">beta</span><span class="o">*</span><span class="n">S</span><span class="o">*</span><span class="n">I</span> <span class="o">-</span> <span class="n">nu</span><span class="o">*</span><span class="n">I</span>
    <span class="n">dRdt</span> <span class="o">=</span>  <span class="n">nu</span><span class="o">*</span><span class="n">I</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dSdt</span><span class="p">,</span><span class="n">dIdt</span><span class="p">,</span><span class="n">dRdt</span><span class="p">]</span>

<span class="c1"># Show a timeline plot of the infection
</span><span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="n">i0</span> <span class="o">=</span> <span class="mf">0.00001</span>
<span class="n">s0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">i0</span>
<span class="n">r0</span> <span class="o">=</span> <span class="mi">0</span>


<span class="n">sol</span> <span class="o">=</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">SIR</span><span class="p">,</span> <span class="p">[</span><span class="n">s0</span><span class="p">,</span><span class="n">i0</span><span class="p">,</span><span class="n">r0</span><span class="p">],</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">mxstep</span><span class="o">=</span><span class="mi">50000</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">sol</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s">'c'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'susceptible'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">sol</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">'k'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'infected'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">sol</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="s">'m'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'recovered'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">pylab</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">'center right'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s">"$\beta="</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s">",\ \nu="</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span><span class="o">+</span><span class="s">",\ R_0="</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">R0</span><span class="p">)</span><span class="o">+</span><span class="s">"$"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'time (days)'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'\% population'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure>

<p>Here is the timeline of the disease produced by the above code. There is a noticable tip and a turning point for the disease, when the amount of viable susceptibles goes low enough. We notice how most of the population goes through the infection and becomes Recovered. The exact timeline and the shapes of the curves depend on the constants in the equation and therefore on the properties of the disease and of the population. These values define a highly contagious disease in a population where it can spread very effectively.</p>

<p><img src="/images/sir1.png" alt="center-aligned-image" class="align-center" /></p>

<p>Next, we wish to study the dynamics of the disease in a “phase-plane” of Infected proportion of the population against the Susceptible proportion of the population. This is another way to find the “tipping point” of the epidemic.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># Draw a phase plot in the S-I plane
# 
</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="p">[</span><span class="n">s0</span><span class="p">,</span><span class="n">i0</span><span class="p">,</span> <span class="n">r0</span><span class="p">]</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">SIR</span><span class="p">,</span> <span class="n">Y0</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">mxstep</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">ys</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s">'c-'</span><span class="p">)</span> <span class="c1"># path
</span><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">([</span><span class="n">ys</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">ys</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="s">'bo'</span><span class="p">)</span> <span class="c1"># start
</span><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">([</span><span class="n">ys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">ys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="s">'bs'</span><span class="p">)</span> <span class="c1"># end
</span><span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s">"$\beta="</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">+</span><span class="sa">r</span><span class="s">",\ \nu="</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span><span class="o">+</span><span class="s">",\ R_0="</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">R0</span><span class="p">)</span><span class="o">+</span><span class="s">"$"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'\% susceptibles'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'\% infecteds'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Final state of epidemic with starting values s0="</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">s0</span><span class="p">)</span><span class="o">+</span><span class="s">", i0="</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i0</span><span class="p">)</span><span class="o">+</span><span class="s">": </span><span class="se">\n</span><span class="s">"</span> <span class="o">+</span>
      <span class="s">"s="</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s">", i="</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span> <span class="s">", r="</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>

<span class="c1"># Determine the point where the curve changes direction
# (num. infecteds starts decreasing so epidemic dies out)
#
# This can be deduced analytically from the equation for dI/dt:
# dI/dt = (beta*S -nu) * I
# as the point where beta*S = nu
</span><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">([</span><span class="n">nu</span><span class="o">/</span><span class="n">beta</span><span class="p">,</span><span class="n">nu</span><span class="o">/</span><span class="n">beta</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])],</span><span class="s">'k-.'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s">"$\beta S = \nu$"</span><span class="p">)</span>
<span class="n">pylab</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">'upper right'</span><span class="p">)</span>

<span class="c1"># Therefore
</span><span class="k">print</span><span class="p">(</span><span class="s">"The number of infecteds in the population will start decreasing after "</span>
       <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">nu</span> <span class="o">/</span> <span class="n">beta</span><span class="p">))</span><span class="o">+</span><span class="s">" days."</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure>

<p>The starting point is the lower-right corner, where we have a fully Susceptible population and only the initial “patient zero” that is introduced into the population. The epidemic then traverses the curve towards the left corner.  The tipping point of the disease is visualized by the vertical line in the image.</p>

<p><img src="/images/sir2.png" alt="center-aligned-image" class="align-center" /></p>

<p>The output of the code also gives the final fractions in the population of the three categories for a disease and a population with these particular values of the parameters. Only a small percentage survived without getting the infection, as we saw also in the previous image.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">Final</span> <span class="n">state</span> <span class="n">of</span> <span class="n">epidemic</span> <span class="k">with</span> <span class="n">starting</span> <span class="n">values</span> <span class="n">s0</span><span class="o">=</span><span class="mf">0.99999</span><span class="p">,</span> <span class="n">i0</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">:</span> 
<span class="n">s</span><span class="o">=</span><span class="mf">0.0160404895464</span><span class="p">,</span> <span class="n">i</span><span class="o">=-</span><span class="mf">1.53270201903e-16</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mf">0.983959510454</span>
<span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">infecteds</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">population</span> <span class="n">will</span> <span class="n">start</span> <span class="n">decreasing</span> <span class="n">after</span> <span class="mi">81</span> <span class="n">days</span><span class="p">.</span></code></pre></figure>

<h1 id="sis-model">SIS-model</h1>

<p>This is a somehow simpler model with different dynamics. Here the equations are as follows.</p>

\[\frac{dS}{dT} = - -\beta S I + \nu  I = \beta (N - I) I - \nu  I\]

\[\frac{dI}{dT} =  \beta S I - \nu   I\]

<p>There are only two categories: Susceptible and Infected. This fundamental model and its variations are useful for modeling endemic sicknesses such as the flu, where immunity is not granted after recovering from infection.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
<span class="c1"># Do some analysis of the SIS-infection model
</span>
<span class="c1"># In this model, we have the following system of two differential equations
# dS/dt = -beta*S*I + nu * I = beta*(N - I)*I - nu * I
# dI/dt =  beta*S*I - nu * I
</span>
<span class="c1"># We wish to look at the time behaviour and steady states of the system computationally
# Analytically, the system can be solved to give the steady state (assuming beta*N &gt; nu, otherwise I -&gt; 0)
# I_inf = N - nu/beta
# S_inf = nu/beta
</span>
<span class="c1"># Set parameters
</span><span class="n">beta</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">nu</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">N</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># Define the system
</span><span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
    <span class="n">S</span><span class="p">,</span><span class="n">I</span> <span class="o">=</span> <span class="n">Y</span>
    <span class="n">dSdt</span> <span class="o">=</span>  <span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">S</span><span class="o">*</span><span class="n">I</span> <span class="o">+</span> <span class="n">nu</span><span class="o">*</span><span class="n">I</span>
    <span class="n">dIdt</span> <span class="o">=</span>  <span class="n">beta</span><span class="o">*</span><span class="n">S</span><span class="o">*</span><span class="n">I</span> <span class="o">-</span> <span class="n">nu</span><span class="o">*</span><span class="n">I</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dSdt</span><span class="p">,</span><span class="n">dIdt</span><span class="p">]</span>

<span class="c1"># Define evaluation points
</span><span class="n">xstart</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0</span>
<span class="n">xend</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">ystart</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0</span>
<span class="n">yend</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">npoints</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xstart</span><span class="p">,</span><span class="n">xend</span><span class="p">,</span> <span class="n">npoints</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ystart</span><span class="p">,</span> <span class="n">yend</span><span class="p">,</span> <span class="n">npoints</span><span class="p">)</span>

<span class="n">Y1</span><span class="p">,</span> <span class="n">Y2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Y1</span><span class="p">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Y2</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">NI</span><span class="p">,</span> <span class="n">NJ</span> <span class="o">=</span> <span class="n">Y1</span><span class="p">.</span><span class="n">shape</span>

<span class="c1"># Calculate derivatives
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NI</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NJ</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">Y1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">Y2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="n">yprime</span> <span class="o">=</span> <span class="n">F</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="n">t</span><span class="p">)</span>
        <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">yprime</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">yprime</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
     
    
<span class="c1"># Plot derivatives
</span><span class="n">Q</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">Y1</span><span class="p">,</span> <span class="n">Y2</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'r'</span><span class="p">)</span>

<span class="n">i0</span> <span class="o">=</span> <span class="mf">0.0000001</span>
<span class="n">s0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">i0</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">Y0</span> <span class="o">=</span> <span class="p">[</span><span class="n">s0</span><span class="p">,</span><span class="n">i0</span><span class="p">]</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">Y0</span><span class="p">,</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">mxstep</span> <span class="o">=</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ys</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">ys</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s">'-'</span><span class="p">)</span> <span class="c1"># path
</span><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">([</span><span class="n">ys</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">ys</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="s">'bo'</span><span class="p">)</span> <span class="c1"># start
</span><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">([</span><span class="n">ys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">ys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="s">'bs'</span><span class="p">)</span> <span class="c1"># end
</span><span class="k">print</span><span class="p">(</span><span class="s">"Endpoint of epidemic with starting values s0="</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span><span class="o">+</span><span class="s">", i0="</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">z0</span><span class="p">)</span><span class="o">+</span><span class="s">": </span><span class="se">\n</span><span class="s">"</span> <span class="o">+</span>
      <span class="s">"s="</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s">", i="</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
    
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'susceptibles'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'% infecteds'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Analytical final state: s="</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nu</span><span class="o">/</span><span class="n">beta</span><span class="p">)</span><span class="o">+</span><span class="s">", i="</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">nu</span><span class="o">/</span><span class="n">beta</span><span class="p">))</span></code></pre></figure>

<p>The transition to the final endemic state of the disease is easily visualized. Again, from the lower right corner towards the end-point of the line. 
<img src="/images/sis1.png" alt="center-aligned-image" class="align-center" /></p>

<p>The same result can be calculated numerically, and for this particular model, also analytically (exactly):</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">Endpoint</span> <span class="n">of</span> <span class="n">epidemic</span> <span class="k">with</span> <span class="n">starting</span> <span class="n">values</span> <span class="n">s0</span><span class="o">=</span><span class="mf">0.9999999</span><span class="p">,</span> <span class="n">i0</span><span class="o">=</span><span class="mf">1e-07</span><span class="p">:</span> 
<span class="n">s</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mf">0.6</span>

<span class="n">Analytical</span> <span class="n">final</span> <span class="n">state</span><span class="p">:</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mf">0.6</span></code></pre></figure>

<p>We can also calculate a timeline plot of population density for this model.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># Show a timeline plot of the infection
</span><span class="kn">import</span> <span class="nn">pylab</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">i0</span> <span class="o">=</span> <span class="mf">0.00001</span>
<span class="n">s0</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">i0</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="n">s0</span><span class="p">,</span><span class="n">i0</span><span class="p">],</span> <span class="n">tspan</span><span class="p">,</span> <span class="n">mxstep</span><span class="o">=</span><span class="mi">50000</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">sol</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s">'c.'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'susceptible'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tspan</span><span class="p">,</span> <span class="n">sol</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">'k.'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'infected'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">pylab</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">'upper right'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'time (days)'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'% population'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure>

<p>Where we see a timeline to the stable state of the system.</p>

<p><img src="/images/sis2.png" alt="center-aligned-image" class="align-center" /></p>

<p><a href="https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology">Further reading</a></p>

        </div>

        
          <span class="social-share-twitter">
  <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-show-count="false">Tweet</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</span>


<span class="social-share-facebook">
  <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/code/2020-03-24-epidemic/" title="Share on Facebook" itemprop="Facebook"><i class="fab fa-facebook"></i> Like</a>
</span>

<!-- /.social-share -->
        

        

        <nav class="page-pagination" role="navigation">
  
    <a class="page-previous" href="/code/2019-12-12-GILFs/">
      <h4 class="page-pagination-label">Previous</h4>
      <span class="page-pagination-title">
        <i class="fas fa-arrow-left"></i> A teenager’s first video game

      </span>
    </a>
  

  
    <a class="page-next" href="/code/2023-05-02-docker-demos/">
      <h4 class="page-pagination-label">Next</h4>
      <span class="page-pagination-title">
        Collection of minimal Docker web servers
 <i class="fas fa-arrow-right"></i>
      </span>
    </a>
  
</nav>

      </div>
    </div>
  </article>
</main>


    <footer id="footer" class="site-footer">
  <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
<div class="social-icons"><a class="social-icon" href="https://github.com/gingerdeer"><i class="fab fa-github-square fa-2x" title="GitHub"></i></a><a class="social-icon" href="https://www.linkedin.com/in/pentti-sunila-a967a1123/"><i class="fab fa-linkedin fa-2x" title="LinkedIn"></i></a><a class="social-icon" href="https://soundcloud.com/gidetrix"><i class="fab fa-soundcloud fa-2x" title="SoundCloud"></i></a><a class="social-icon" href="https://dream-lands.bandcamp.com/"><i class="fab fa-bandcamp fa-2x" title="Bandcamp"></i></a><a class="social-icon" href="https://twitter.com/_penatrix"><i class="fab fa-twitter fa-2x" title="Twitter"></i></a></div><div class="copyright">
    
      <p>&copy; 2024 Pena, WTF?. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/mmistakes/so-simple-theme" rel="nofollow">So Simple</a>.</p>
    
  </div>
</footer>

    <script type="text/javascript">
  var BASE_URL = 'http://localhost:4000';
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<!-- <script src="http://localhost:4000/assets/js/scripts.min.js"></script> -->
<script src="http://localhost:4000/assets/js/main.min.js"></script>
<script src="http://localhost:4000/assets/js/inspirational.js"></script>
<!-- <script src="http://localhost:4000/assets/js/main.js"></script> -->
  <script src="https://use.fontawesome.com/releases/v5.0.12/js/all.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-161776959-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-161776959-1');
</script>

  </body>

</html>
