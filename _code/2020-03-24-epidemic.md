---
title: "ABCs of mathematical epidemiology"
last_modified_at:
tags:
author: pena
  
---

Jupyter notebooks on infectious disease dynamics.

[From my Github.](https://github.com/gingerdeer/infectionmodelingcourse)

The topic is fashionable at the moment due to the Corona virus situation, so I decided to post these notebooks here. I wrote them during a course on mathematical modeling of infectious disease dynamics and they cover some of the basic topics from the course. These so-called compartmental models of epidemiology are famous, mathematically and intuitively simple, and also powerful. Many papers published nowadays still rely on more complicated and detailed models based on these. The SIR model is highly famous fundamental model and a lot has been written about it in literature and online.

# SIR-model

$$ \frac{dS}{dT} = - \beta S I $$

$$ \frac{dI}{dT} = \beta S I - \nu I $$

$$ \frac{dR}{dT} = \nu I $$

{% highlight python %}
# Analysis & visualization of the basic SIR model
%matplotlib inline
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint
import pylab
# This allows using \TeX in matplotlib
plt.rc('text', usetex=True)
plt.rc('font', family='serif')

# Set parameters
beta = 0.21
nu = 0.05
N = 1.0

# basic reproduction number
R0 = beta / nu

# Define model
def SIR(Y,t):
    S,I,R = Y
    dSdt =  -beta*S*I
    dIdt =  beta*S*I - nu*I
    dRdt =  nu*I
    return [dSdt,dIdt,dRdt]

# Show a timeline plot of the infection
tspan = np.linspace(0, 150, 150)
i0 = 0.00001
s0 = 1.0 - i0
r0 = 0


sol = ys = odeint(SIR, [s0,i0,r0], tspan, mxstep=50000)
plt.plot(tspan, sol[:, 0], 'c', label='susceptible')
plt.plot(tspan, sol[:, 1], 'k', label='infected')
plt.plot(tspan, sol[:, 2], 'm', label='recovered')
plt.grid()
pylab.legend(loc='center right')
plt.title(r"$\beta="+str(beta)+r",\ \nu="+str(nu)+",\ R_0="+str(R0)+"$")
plt.xlabel('time (days)')
plt.ylabel('\% population')
plt.show()

{% endhighlight %}

![center-aligned-image](/images/sir1.png){: .align-center}

{% highlight python %}
# Draw a phase plot in the S-I plane
# 

tspan = np.linspace(0, 10000, 10000)
Y0 = [s0,i0, r0]
ys = odeint(SIR, Y0, tspan, mxstep = 500)
plt.plot(ys[:,0], ys[:,1], 'c-') # path
plt.plot([ys[0,0]], [ys[0,1]], 'bo') # start
plt.plot([ys[-1,0]], [ys[-1,1]], 'bs') # end
plt.title(r"$\beta="+str(beta)+r",\ \nu="+str(nu)+",\ R_0="+str(R0)+"$")
plt.xlabel('\% susceptibles')
plt.ylabel('\% infecteds')
print("Final state of epidemic with starting values s0="+str(s0)+", i0="+str(i0)+": \n" +
      "s="+ str(ys[-1,0])+", i="+ str(ys[-1,1])+ ", r="+str(ys[-1,2]))

# Determine the point where the curve changes direction
# (num. infecteds starts decreasing so epidemic dies out)
#
# This can be deduced analytically from the equation for dI/dt:
# dI/dt = (beta*S -nu) * I
# as the point where beta*S = nu
plt.plot([nu/beta,nu/beta],[0,np.max(ys[:,1])],'k-.',label=r"$\beta S = \nu$")
pylab.legend(loc='upper right')

# Therefore
print("The number of infecteds in the population will start decreasing after "
       +str(np.argmax(ys[:,0] < nu / beta))+" days.")

plt.show()
{% endhighlight %}

![center-aligned-image](/images/sir2.png){: .align-center}
{% highlight python %}


Final state of epidemic with starting values s0=0.99999, i0=1e-05: 
s=0.0160404895464, i=-1.53270201903e-16, r=0.983959510454
The number of infecteds in the population will start decreasing after 81 days.
{% endhighlight %}

# SIS-model

{% highlight python %}
%matplotlib inline
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint
# Do some analysis of the SIS-infection model

# In this model, we have the following system of two differential equations
# dS/dt = -beta*S*I + nu * I = beta*(N - I)*I - nu * I
# dI/dt =  beta*S*I - nu * I

# We wish to look at the time behaviour and steady states of the system computationally
# Analytically, the system can be solved to give the steady state (assuming beta*N > nu, otherwise I -> 0)
# I_inf = N - nu/beta
# S_inf = nu/beta

# Set parameters
beta = 0.5
nu = 0.2
N = 1.0

# Define the system
def F(Y,t):
    S,I = Y
    dSdt =  -beta*S*I + nu*I
    dIdt =  beta*S*I - nu*I
    return [dSdt,dIdt]

# Define evaluation points
xstart = -0.0
xend = 1.0
ystart = -0.0
yend = 1.0
npoints = 20

y1 = np.linspace(xstart,xend, npoints)
y2 = np.linspace(ystart, yend, npoints)

Y1, Y2 = np.meshgrid(y1, y2)

t = 0

u, v = np.zeros(Y1.shape), np.zeros(Y2.shape)

NI, NJ = Y1.shape

# Calculate derivatives
for i in range(NI):
    for j in range(NJ):
        x = Y1[i, j]
        y = Y2[i, j]
        yprime = F([x, y], t)
        u[i,j] = yprime[0]
        v[i,j] = yprime[1]
     
    
# Plot derivatives
Q = plt.quiver(Y1, Y2, u, v, color='r')

i0 = 0.0000001
s0 = 1.0 - i0
tspan = np.linspace(0, 1000, 100)
Y0 = [s0,i0]
ys = odeint(F, Y0, tspan, mxstep = 500)
plt.plot(ys[:,0], ys[:,1], '-') # path
plt.plot([ys[0,0]], [ys[0,1]], 'bo') # start
plt.plot([ys[-1,0]], [ys[-1,1]], 'bs') # end
print("Endpoint of epidemic with starting values s0="+str(y0)+", i0="+str(z0)+": \n" +
      "s="+ str(ys[-1,0])+", i="+ str(ys[-1,1]))
    
plt.xlabel('susceptibles')
plt.ylabel('% infecteds')
plt.show()
print("Analytical final state: s="+str(nu/beta)+", i="+str(N - nu/beta))
{% endhighlight %}

![center-aligned-image](/images/sis1.png){: .align-center}

{% highlight python %}
Endpoint of epidemic with starting values s0=0.9999999, i0=1e-07: 
s=0.4, i=0.6

Analytical final state: s=0.4, i=0.6
{% endhighlight %}


{% highlight python %}
# Show a timeline plot of the infection
import pylab
tspan = np.linspace(0, 100, 100)
i0 = 0.00001
s0 = 1.0 - i0
sol = ys = odeint(F, [s0,i0], tspan, mxstep=50000)
plt.plot(tspan, sol[:, 0], 'c.', label='susceptible')
plt.plot(tspan, sol[:, 1], 'k.', label='infected')
plt.grid()
pylab.legend(loc='upper right')
plt.xlabel('time (days)')
plt.ylabel('% population')
plt.show()
{% endhighlight %}

![center-aligned-image](/images/sis2.png){: .align-center}

TODO